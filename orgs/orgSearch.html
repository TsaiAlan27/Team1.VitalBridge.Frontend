<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Èï∑ÁÖßÊ©üÊßãÊêúÂ∞ã - Ê®ÇÈΩ°Ê©ã VitalBridge</title>
    <meta name="description" content="ÊêúÂ∞ãÈÅ©ÂêàÁöÑÈï∑ÁÖßÊ©üÊßãÔºåÊèê‰æõÂæ©ÂÅ•‰∏≠ÂøÉ„ÄÅÊó•ÈñìÁÖßË≠∑‰∏≠ÂøÉ„ÄÅË≠∑ÁêÜ‰πãÂÆ∂Á≠âÂ§öÁ®ÆÊúçÂãôÈ°ûÂûã">
    <meta name="keywords" content="Èï∑ÁÖßÊ©üÊßã,È§äË≠∑‰∏≠ÂøÉ,Ë≠∑ÁêÜ‰πãÂÆ∂,Êó•ÈñìÁÖßË≠∑,Âæ©ÂÅ•‰∏≠ÂøÉ,Âú®ÂÆÖÈ§äË≠∑">

    <!-- Open Graph tags -->
    <meta property="og:title" content="Èï∑ÁÖßÊ©üÊßãÊêúÂ∞ã - Ê®ÇÈΩ°Ê©ã VitalBridge">
    <meta property="og:description" content="ÊêúÂ∞ãÈÅ©ÂêàÁöÑÈï∑ÁÖßÊ©üÊßãÔºåÊèê‰æõÂæ©ÂÅ•‰∏≠ÂøÉ„ÄÅÊó•ÈñìÁÖßË≠∑‰∏≠ÂøÉ„ÄÅË≠∑ÁêÜ‰πãÂÆ∂Á≠âÂ§öÁ®ÆÊúçÂãôÈ°ûÂûã">
    <meta property="og:type" content="website">

    <!-- Favicons -->
    <link href="/assets/img/favicon.png" rel="icon">
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="/assets/css/main.css" rel="stylesheet">

    <!-- Ëá™Â∑±ÊÉ≥ÊîπÁöÑÊ®£ÂºèÊîæÈÄôÈÇä -->
    <style>
        /* Ê©üÊßãÊêúÂ∞ãÈ†ÅÈù¢Ëá™Ë®ÇÊ®£Âºè */
        .search-container {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 2rem 0;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .search-form {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.75rem;
        }

        .price-range-container {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        .price-display {
            font-size: 1.1rem;
            font-weight: 600;
            color: #28a745;
        }

        .checkbox-group {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        .form-check-input:checked {
            background-color: #007bff;
            border-color: #007bff;
        }

        .search-btn {
            background: linear-gradient(45deg, #007bff, #0056b3);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.3);
        }

        .org-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
            overflow: hidden;
            min-height: 280px;
        }

        .org-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .clickable-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clickable-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            background-color: #f8f9fa;
        }

        .clickable-card:active {
            transform: translateY(-1px);
        }

        .org-image {
            width: calc(100% - 30px);
            height: calc(100% - 30px);
            object-fit: cover;
            border-radius: 10px;
            position: absolute;
            top: 15px;
            left: 15px;
        }

        .card-img-container {
            height: 200px;
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .card-img-container.no-image {
            width: calc(100% - 30px);
            height: calc(100% - 30px);
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #dee2e6;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px;
            border-radius: 10px;
        }

        .card-img-container.no-image::after {
            content: "üì∑\AÊö´ÁÑ°ÁÖßÁâá";
            white-space: pre;
            text-align: center;
            color: #6c757d;
            font-size: 2rem;
            line-height: 1.2;
        }

        .org-title {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }

        .org-location {
            color: #6c757d;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .org-address {
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
        }

        .org-price {
            color: #28a745;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .detail-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .detail-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .loading-spinner {
            color: #007bff;
        }

        .pagination {
            justify-content: center;
            margin-top: 2rem;
        }

        .page-link {
            border-radius: 8px;
            margin: 0 2px;
            border: none;
            background: #f8f9fa;
            color: #495057;
        }

        .page-link:hover {
            background: #007bff;
            color: white;
        }

        .page-item.active .page-link {
            background: #007bff;
            border-color: #007bff;
        }

        .breadcrumb {
            background: transparent;
            padding: 0;
            margin-bottom: 1rem;
        }

        .breadcrumb-item+.breadcrumb-item::before {
            content: ">";
            color: #6c757d;
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        /* ÁâπËâ≤ÊúçÂãôÂúñÁ§∫Ê®£Âºè */
        .feature-services {
            margin-top: 1rem;
        }

        .feature-services-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .feature-service-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .feature-service-icon {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .feature-service-icon:hover {
            transform: scale(1.1);
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
        }

        .feature-service-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .feature-service-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #6c757d;
        }

        .feature-service-name {
            font-size: 1rem;
            color: #495057;
            line-height: 1.2;
            word-break: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            line-clamp: 2;
        }

        /* Á∞°ÊΩîÁöÑÊéíÂ∫èÈÅ∏È†ÖÊ®£Âºè */
        .sort-options-wrapper {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #dee2e6;
        }

        .sort-item {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: nowrap;
        }

        .sort-label {
            font-weight: 600;
            color: #495057;
            white-space: nowrap;
            min-width: fit-content;
            margin-bottom: 0;
            font-size: 0.95rem;
        }

        .sort-item .btn-group {
            flex-shrink: 0;
        }

        .sort-item .btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .page-select {
            width: auto;
            min-width: 120px;
            flex-shrink: 0;
        }

        /* ÈüøÊáâÂºèË™øÊï¥ */
        @media (max-width: 992px) {
            .sort-item {
                margin-bottom: 15px;
            }
        }

        @media (max-width: 768px) {
            .sort-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .sort-label {
                align-self: flex-start;
            }

            .sort-item .btn-group {
                width: 100%;
            }

            .sort-item .btn {
                flex: 1;
                font-size: 0.8rem;
                padding: 0.3rem 0.6rem;
            }

            .page-select {
                width: 100%;
            }

            /* ÊâãÊ©üÊ®°Âºè‰∏ãÁöÑÊ©üÊßãÂç°ÁâáË™øÊï¥ */
            .org-card .col-md-8 {
                margin-bottom: 1rem;
            }

            .org-card .col-md-4,
            .text-center-mobile {
                text-align: center !important;
                margin-top: 1rem;
            }

            .detail-btn {
                width: 100%;
                font-size: 1rem;
                padding: 0.75rem 1rem;
                margin-top: 1rem;
            }

            /* Á¢∫‰øùÂÉπÊ†ºÂíåÂ∫ä‰ΩçÊï∏Âú®ÊâãÊ©üÊ®°Âºè‰∏ãÂ±Ö‰∏≠È°ØÁ§∫ */
            .org-card .col-md-4>div {
                text-align: center;
                margin-bottom: 1rem;
            }

            /* ÊâãÊ©üÊ®°Âºè‰∏ãÁöÑÊ©üÊßãÂúñÁâáË™øÊï¥ */
            .card-img-container {
                margin-bottom: 1rem;
            }

            /* ÊâãÊ©üÊ®°Âºè‰∏ãÁöÑÂèØÈªûÊìäÂç°ÁâáÊ®£Âºè */
            .clickable-card {
                border: 2px solid transparent;
                position: relative;
            }

            .clickable-card::after {
                content: 'ÈªûÊìäÊü•ÁúãË©≥ÊÉÖ';
                position: absolute;
                top: 10px;
                right: 10px;
                background: rgba(40, 167, 69, 0.9);
                color: white;
                padding: 4px 8px;
                border-radius: 12px;
                font-size: 0.75rem;
                font-weight: 500;
                z-index: 5;
            }

            .clickable-card:hover {
                border-color: #28a745;
                background-color: #f8fff9;
            }
        }
    </style>

</head>

<body>
    <div class="headerpage"></div>

    <main class="main">
        <!-- Breadcrumb Navigation -->
        <section class="py-2">
            <div class="container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/index.html">È¶ñÈ†Å</a></li>
                        <li class="breadcrumb-item active" aria-current="page">ÊâæÊ©üÊßã</li>
                    </ol>
                </nav>
            </div>
        </section>

        <!-- Search Section -->
        <section id="searchApp" class="section">
            <div class="container">
                <div class="search-container">
                    <div class="text-center mb-4">
                        <h1 class="fw-bold text-primary">Èï∑ÁÖßÊ©üÊßãÊêúÂ∞ã</h1>
                        <p class="lead text-muted">ÊâæÂà∞ÊúÄÈÅ©ÂêàÁöÑÈï∑ÁÖßÊ©üÊßã</p>
                    </div>

                    <div class="search-form">
                        <div class="row g-3">
                            <!-- ÈóúÈçµÂ≠óÊêúÂ∞ã -->
                            <div class="col-md-6">
                                <label for="keyword" class="form-label">
                                    <i class="bi bi-search me-2"></i>Ê©üÊßãÂêçÁ®±
                                </label>
                                <input type="text" class="form-control" id="keyword" v-model="searchForm.keyword"
                                    placeholder="Ë´ãËº∏ÂÖ•Ê©üÊßãÂêçÁ®±ÈóúÈçµÂ≠ó" aria-label="Ê©üÊßãÂêçÁ®±ÊêúÂ∞ã" @keyup.enter="performNewSearch">
                            </div>

                            <!-- Á∏£Â∏ÇÈÅ∏Êìá -->
                            <div class="col-md-3">
                                <label for="city" class="form-label">
                                    <i class="bi bi-geo-alt me-2"></i>Á∏£Â∏Ç
                                </label>
                                <select class="form-select" id="city" v-model="searchForm.cityId" @change="onCityChange"
                                    aria-label="ÈÅ∏ÊìáÁ∏£Â∏Ç">
                                    <option value="0">ÂÖ®ÈÉ®Á∏£Â∏Ç</option>
                                    <option v-for="city in cities" :key="city.id" :value="city.id">
                                        {{ city.name }}
                                    </option>
                                </select>
                            </div>

                            <!-- ÈÑâÈéÆÂçÄÈÅ∏Êìá -->
                            <div class="col-md-3">
                                <label for="district" class="form-label">
                                    <i class="bi bi-map me-2"></i>ÈÑâÈéÆÂçÄ
                                </label>
                                <select class="form-select" id="district" v-model="searchForm.districtId"
                                    :disabled="!searchForm.cityId || searchForm.cityId === 0" aria-label="ÈÅ∏ÊìáÈÑâÈéÆÂçÄ">
                                    <option value="0">ÂÖ®ÈÉ®ÈÑâÈéÆÂçÄ</option>
                                    <option v-for="district in districts" :key="district.id" :value="district.id">
                                        {{ district.name }}
                                    </option>
                                </select>
                            </div>

                            <!-- ÂÉπÊ†ºÁØÑÂúç -->
                            <div class="col-md-6">
                                <label for="priceRange" class="form-label">
                                    <i class="bi bi-currency-dollar me-2"></i>ÂÉπÊ†ºÁØÑÂúç
                                </label>
                                <div class="price-range-container">
                                    <input type="range" class="form-range" id="priceRange" v-model="searchForm.maxPrice"
                                        min="0" max="500000" step="5000" aria-label="ÂÉπÊ†ºÁØÑÂúçÈÅ∏Êìá">

                                    <!-- ÂÉπÊ†ºËº∏ÂÖ•Ê°Ü -->
                                    <div class="row g-2 mt-2">
                                        <div class="col-6">
                                            <label class="form-label small">ÊúÄ‰ΩéÂÉπÊ†º</label>
                                            <input type="number" class="form-control form-control-sm"
                                                v-model.number="searchForm.minPrice" min="0" max="500000" step="1000"
                                                placeholder="0" aria-label="ÊúÄ‰ΩéÂÉπÊ†ºËº∏ÂÖ•" @keyup.enter="performNewSearch">
                                        </div>
                                        <div class="col-6">
                                            <label class="form-label small">ÊúÄÈ´òÂÉπÊ†º</label>
                                            <input type="number" class="form-control form-control-sm"
                                                v-model.number="searchForm.maxPrice" min="0" max="500000" step="1000"
                                                placeholder="500000" aria-label="ÊúÄÈ´òÂÉπÊ†ºËº∏ÂÖ•"
                                                @keyup.enter="performNewSearch">
                                        </div>
                                    </div>

                                    <div class="d-flex justify-content-between mt-2">
                                        <span class="price-display">NT$ {{ formatPrice(searchForm.minPrice || 0)
                                            }}</span>
                                        <span class="price-display">NT$ {{ formatPrice(searchForm.maxPrice) }}</span>
                                    </div>
                                    <div class="text-center mt-1">
                                        <small class="text-muted">
                                            ÂÉπÊ†ºÁØÑÂúçÔºöNT$ {{ formatPrice(searchForm.minPrice || 0) }} - NT$ {{
                                            formatPrice(searchForm.maxPrice) }}
                                        </small>
                                    </div>
                                </div>
                            </div>

                            <!-- Ê©üÊßãÈ°ûÂûã -->
                            <div class="col-md-6">
                                <label class="form-label">
                                    <i class="bi bi-building me-2"></i>Ê©üÊßãÈ°ûÂûã
                                </label>
                                <div class="checkbox-group">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="selectAll"
                                            v-model="selectAll" @change="toggleSelectAll" aria-label="ÈÅ∏ÊìáÂÖ®ÈÉ®Ê©üÊßãÁâπËâ≤">
                                        <label class="form-check-label fw-bold" for="selectAll">
                                            ÂÖ®ÈÉ®
                                        </label>
                                    </div>
                                    <div v-for="type in organizationTypes" :key="type.id" class="form-check">
                                        <input class="form-check-input" type="checkbox" :id="'type_' + type.id"
                                            :value="type.id" v-model="searchForm.organizationTypeIds"
                                            @change="onTypeChange" :aria-label="'ÈÅ∏Êìá' + type.name">
                                        <label class="form-check-label" :for="'type_' + type.id">
                                            {{ type.name }}
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- ÊêúÂ∞ãÊåâÈàï -->
                            <div class="col-12 text-center">
                                <button type="button" class="btn btn-primary search-btn" @click="performNewSearch"
                                    :disabled="loading" aria-label="ÊêúÂ∞ãÊ©üÊßã">
                                    <span v-if="loading" class="spinner-border spinner-border-sm me-2" role="status"
                                        aria-hidden="true"></span>
                                    <i v-else class="bi bi-search me-2"></i>
                                    {{ loading ? 'ÊêúÂ∞ã‰∏≠...' : 'ÊêúÂ∞ãÊ©üÊßã' }}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error Message -->
                <div v-if="errorMessage" class="error-message" role="alert">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    {{ errorMessage }}
                </div>

                <!-- Search Results -->
                <div v-if="searchResults.length > 0">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3>ÊêúÂ∞ãÁµêÊûú ({{ totalResults }} Á≠Ü)</h3>
                        <small class="text-muted">Á¨¨ {{ currentPage }} È†ÅÔºåÂÖ± {{ totalPages }} È†Å</small>
                    </div>

                    <!-- ÊéíÂ∫èÈÅ∏È†ÖËàáÂàÜÈ†ÅË®≠ÂÆö -->
                    <div class="sort-options-wrapper mb-4">
                        <div class="row g-3">
                            <!-- ÂÉπÊ†ºÊéíÂ∫è -->
                            <div class="col-lg-4 col-md-6">
                                <div class="sort-item">
                                    <label class="sort-label">
                                        <i class="bi bi-currency-dollar text-primary me-1"></i>ÂÉπÊ†ºÊéíÂ∫è:
                                    </label>
                                    <div class="btn-group" role="group">
                                        <input type="radio" class="btn-check" name="priceSort" id="priceNone" value=""
                                            v-model="priceSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-secondary" for="priceNone">‰∏çÊéíÂ∫è</label>

                                        <input type="radio" class="btn-check" name="priceSort" id="priceLowToHigh"
                                            value="asc" v-model="priceSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-primary" for="priceLowToHigh">Áî±‰ΩéÂà∞È´ò</label>

                                        <input type="radio" class="btn-check" name="priceSort" id="priceHighToLow"
                                            value="desc" v-model="priceSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-primary" for="priceHighToLow">Áî±È´òÂà∞‰Ωé</label>
                                    </div>
                                </div>
                            </div>

                            <!-- Â∫ä‰ΩçÊéíÂ∫è -->
                            <div class="col-lg-4 col-md-6">
                                <div class="sort-item">
                                    <label class="sort-label">
                                        <i class="bi bi-house-door text-success me-1"></i>Â∫ä‰ΩçÊéíÂ∫è:
                                    </label>
                                    <div class="btn-group" role="group">
                                        <input type="radio" class="btn-check" name="bedSort" id="bedNone" value=""
                                            v-model="bedSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-secondary" for="bedNone">‰∏çÊéíÂ∫è</label>

                                        <input type="radio" class="btn-check" name="bedSort" id="bedLowToHigh"
                                            value="asc" v-model="bedSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-success" for="bedLowToHigh">Áî±Â∞ëÂà∞Â§ö</label>

                                        <input type="radio" class="btn-check" name="bedSort" id="bedHighToLow"
                                            value="desc" v-model="bedSortBy" @change="performNewSearch">
                                        <label class="btn btn-outline-success" for="bedHighToLow">Áî±Â§öÂà∞Â∞ë</label>
                                    </div>
                                </div>
                            </div>

                            <!-- ÊØèÈ†ÅÈ°ØÁ§∫Á≠ÜÊï∏ -->
                            <div class="col-lg-4 col-md-12">
                                <div class="sort-item">
                                    <label class="sort-label">
                                        <i class="bi bi-grid-3x3-gap text-info me-1"></i>ÊØèÈ†ÅÈ°ØÁ§∫:
                                    </label>
                                    <select class="form-select page-select" v-model="pageSize" @change="changePageSize">
                                        <option value="10">10 Á≠Ü</option>
                                        <option value="15">15 Á≠Ü</option>
                                        <option value="20">20 Á≠Ü</option>
                                        <option value="25">25 Á≠Ü</option>
                                        <option value="30">30 Á≠Ü</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div v-for="org in searchResults" :key="org.id" class="col-12">
                            <div class="card org-card h-100" @click="handleCardClick(org.id, $event)"
                                :class="{ 'clickable-card': isMobileOrTablet() }">
                                <div class="row g-0 h-100">
                                    <div class="col-md-3 d-flex align-items-center">
                                        <div v-if="getImageUrl(org.photoUrl)"
                                            class="card-img-container position-relative">
                                            <img :src="getImageUrl(org.photoUrl)" :data-filename="org.photoUrl"
                                                :alt="org.name + 'Ê©üÊßãÁÖßÁâá'" class="org-image" loading="lazy"
                                                @error="handleImageError($event)">
                                        </div>
                                        <div v-else class="card-img-container no-image">
                                        </div>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="card-body d-flex flex-column justify-content-between h-100">
                                            <div class="row flex-grow-1">
                                                <div class="col-md-8 d-flex flex-column">
                                                    <h5 class="card-title org-title">{{ org.name }}</h5>
                                                    <p class="org-location">
                                                        <i class="bi bi-geo-alt me-1"></i>
                                                        {{ org.cityName }}{{ org.districtName }}
                                                    </p>
                                                    <p class="card-text text-muted org-address">{{ org.address }}</p>

                                                    <!-- ÁâπËâ≤ÊúçÂãôÂúñÁ§∫ -->
                                                    <div v-if="org.featureServiceNames && org.featureServiceNames.length > 0"
                                                        class="feature-services">
                                                        <small class="text-muted d-block mb-1">ÁâπËâ≤ÊúçÂãôÔºö</small>
                                                        <div class="feature-services-grid">
                                                            <div v-for="(serviceName, index) in org.featureServiceNames.slice(0, 8)"
                                                                :key="index" class="feature-service-item"
                                                                :title="serviceName">
                                                                <div class="feature-service-icon">
                                                                    <img v-if="getFeatureServiceImage(serviceName)"
                                                                        :src="getFeatureServiceImage(serviceName)"
                                                                        :alt="serviceName" class="feature-service-img"
                                                                        loading="lazy"
                                                                        @error="handleFeatureServiceImageError($event)">
                                                                    <div v-else class="feature-service-placeholder">
                                                                        <i class="bi bi-star"></i>
                                                                    </div>
                                                                </div>
                                                                <span class="feature-service-name">{{ serviceName
                                                                    }}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-md-4 col-12 d-flex flex-column justify-content-between text-end text-center-mobile h-100">
                                                    <div>
                                                        <div class="mb-2">
                                                            <small class="text-muted">Â∫ä‰ΩçÊï∏: {{ org.bedCount }}</small>
                                                        </div>
                                                        <div class="mb-3">
                                                            <span class="org-price">NT$ {{
                                                                formatPrice(org.minMonthlyPrice)
                                                                }} Ëµ∑</span>
                                                        </div>
                                                    </div>
                                                    <div class="mt-auto">
                                                        <button type="button" class="btn btn-success detail-btn w-100"
                                                            @click.stop="viewDetail(org.id)"
                                                            :class="{ 'd-none d-lg-block': isMobileOrTablet() }"
                                                            :aria-label="'Êü•Áúã' + org.name + 'Ë©≥Á¥∞Ë≥áÊñô'">
                                                            Ë©≥Á¥∞Ë≥áÊñô
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <nav aria-label="ÊêúÂ∞ãÁµêÊûúÂàÜÈ†Å">
                        <ul class="pagination">
                            <li class="page-item" :class="{ disabled: currentPage === 1 }">
                                <button class="page-link" @click="goToPage(currentPage - 1)"
                                    :disabled="currentPage === 1" aria-label="‰∏ä‰∏ÄÈ†Å">
                                    <i class="bi bi-chevron-left"></i>
                                </button>
                            </li>

                            <li v-for="page in visiblePages" :key="page" class="page-item"
                                :class="{ active: currentPage === page }">
                                <button class="page-link" @click="goToPage(page)" :aria-label="'Á¨¨' + page + 'È†Å'">
                                    {{ page }}
                                </button>
                            </li>

                            <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                                <button class="page-link" @click="goToPage(currentPage + 1)"
                                    :disabled="currentPage === totalPages" aria-label="‰∏ã‰∏ÄÈ†Å">
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            </li>
                        </ul>
                    </nav>
                </div>

                <!-- No Results -->
                <div v-else-if="!loading && hasSearched" class="no-results">
                    <i class="bi bi-search display-1 text-muted"></i>
                    <h3 class="mt-3">Êâæ‰∏çÂà∞Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑÊ©üÊßã</h3>
                    <p>Ë´ãË™øÊï¥ÊêúÂ∞ãÊ¢ù‰ª∂ÂæåÂÜçË©¶‰∏ÄÊ¨°</p>
                </div>

                <!-- Initial State -->
                <div v-else-if="!loading && !hasSearched" class="no-results">
                    <i class="bi bi-building display-1 text-muted"></i>
                    <h3 class="mt-3">Ë´ãË®≠ÂÆöÊêúÂ∞ãÊ¢ù‰ª∂</h3>
                    <p>Ëº∏ÂÖ•ÈóúÈçµÂ≠óÊàñÈÅ∏ÊìáÁØ©ÈÅ∏Ê¢ù‰ª∂ÈñãÂßãÊêúÂ∞ã</p>
                </div>
            </div>
        </section>
    </main>

    <div class="footerpage"></div>

    <!-- Scroll Top -->
    <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>
    <!-- Preloader -->
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/vendor/php-email-form/validate.js"></script>
    <script src="/assets/vendor/aos/aos.js"></script>
    <script src="/assets/vendor/waypoints/noframework.waypoints.js"></script>
    <script src="/assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="/assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="/assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="/assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>

    <!-- ÂÖ∂‰ªñË¶ÅË£ùÁöÑjsÊîæÂú®ÈÄô‰πãÂâç -->
    <script src="/assets/js/fragment-loader.js" defer></script>

</body>

<!-- Simple page hook: Âú®‰∏ãÈù¢ÂçÄÂ°äÁõ¥Êé•ÂØ´È†ÅÈù¢Â∞àÂ±¨ÁöÑ JSÔºàÊ≠§ÂáΩÂºèÊúÉÁ≠âÂà∞ fragment-loader ÁôºÂá∫ app:ready ‰∏î window.load ÂÆåÊàêÂæåÂü∑Ë°åÔºâ -->
<script>
    (function onFullyReady(run) {
        function once(ev) { return new Promise(res => { function h(e) { window.removeEventListener(ev, h); res(e); } window.addEventListener(ev, h); }); }
        function waitAppReady() { if (window.appReadyAt !== undefined) return Promise.resolve(); return once('app:ready'); }
        function waitWindowLoad() { if (document.readyState === 'complete') return Promise.resolve(); return once('load'); }
        Promise.all([waitAppReady(), waitWindowLoad()]).then(run);
    })(function () {
        // ===== Âú®‰∏ãÈù¢ÊîæÈ†ÅÈù¢Â∞àÂ±¨ÁöÑ JSÔºàÂè™ÊúÉÂú®ÊâÄÊúâÁâáÊÆµËàáË≥áÊ∫êËºâÂÖ•ÂÆåÊàêÂæåÂü∑Ë°åÔºâ =====

        //VueÁöÑÈÉ®ÂàÜÂØ´ÈÄôÈÇä
        (function mountVue() {
            // ÊääÈ†ÅÈù¢Â∞àÂ±¨ÁöÑ Vue Á®ãÂºèÂØ´Âú®ÈÄôÂÄãÂáΩÂºèË£°
            function initPageVue() {
                if (typeof Vue === 'undefined') return; // Ëã•Êú™ËºâÂÖ• Vue ÂâáË∑≥ÈÅé
                if (typeof axios === 'undefined') return; // Ëã•Êú™ËºâÂÖ• axios ÂâáË∑≥ÈÅé

                const { createApp } = Vue;

                // API ÈÖçÁΩÆÂ∏∏Êï∏
                const API_BASE_URL = 'https://localhost:7104';
                const BACKEND_BASE_URL = 'https://localhost:7184'; // ÂæåÂè∞ API Âü∫Á§é URL

                // Ê©üÊßãÁõ∏Èóú API ÊúçÂãô
                const orgApi = {
                    getCities: () => apiClient.get('/api/Organizations/cities'),
                    getOrganizationTypes: () => apiClient.get('/api/Organizations/organization-types'),
                    getDistricts: (cityId) => apiClient.get(`/api/Organizations/cities/${cityId}/districts`),
                    searchOrganizations: (data) => apiClient.post('/api/Organizations/search', data),
                    getFeatureServices: () => apiClient.get('/api/Organizations/feature-services')
                };

                // Axios ÈÖçÁΩÆ
                const apiClient = axios.create({
                    baseURL: API_BASE_URL,
                    timeout: 30000,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                // Axios ÈåØË™§ÊîîÊà™Âô®
                apiClient.interceptors.response.use(
                    response => response,
                    error => {
                        let errorMessage = 'Á∂≤Ë∑ØÈÄ£Á∑öÁï∞Â∏∏ÔºåË´ãÁ®çÂæåÂÜçË©¶';

                        if (error.response) {
                            errorMessage = `‰º∫ÊúçÂô®ÈåØË™§ (${error.response.status})`;
                        } else if (error.request) {
                            errorMessage = 'ÁÑ°Ê≥ïÈÄ£Á∑öÂà∞‰º∫ÊúçÂô®ÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÈÄ£Á∑ö';
                        }

                        return Promise.reject({ message: errorMessage, originalError: error });
                    }
                );

                createApp({
                    data() {
                        return {
                            // ÊêúÂ∞ãË°®ÂñÆ
                            searchForm: {
                                keyword: '',
                                cityId: 0,
                                districtId: 0,
                                minPrice: 0,
                                maxPrice: 500000,
                                organizationTypeIds: [],
                                featureServiceIds: []
                            },

                            // ‰∏ãÊãâÈÅ∏ÂñÆË≥áÊñô
                            cities: [],
                            districts: [],
                            organizationTypes: [],

                            // ÊêúÂ∞ãÁµêÊûú
                            searchResults: [],
                            allSearchResults: [], // ÂÑ≤Â≠òÊâÄÊúâÊêúÂ∞ãÁµêÊûúÁî®ÊñºÂâçÁ´ØÊéíÂ∫èÂàÜÈ†Å
                            totalResults: 0,
                            currentPage: 1,
                            totalPages: 1,
                            pageSize: 10,

                            // ÊéíÂ∫èÈÅ∏È†Ö
                            priceSortBy: '', // ÂÉπÊ†ºÊéíÂ∫èÔºö''(‰∏çÊéíÂ∫è), 'asc'(Áî±‰ΩéÂà∞È´ò), 'desc'(Áî±È´òÂà∞‰Ωé)
                            bedSortBy: '', // Â∫ä‰ΩçÊéíÂ∫èÔºö''(‰∏çÊéíÂ∫è), 'asc'(Áî±Â∞ëÂà∞Â§ö), 'desc'(Áî±Â§öÂà∞Â∞ë)

                            // ÁâπËâ≤ÊúçÂãôË≥áÊñôÂø´Âèñ
                            featureServicesCache: new Map(),

                            // ÁãÄÊÖãÁÆ°ÁêÜ
                            loading: false,
                            hasSearched: false,
                            errorMessage: '',
                            selectAll: false
                        };
                    },

                    computed: {
                        visiblePages() {
                            const pages = [];
                            const start = Math.max(1, this.currentPage - 2);
                            const end = Math.min(this.totalPages, this.currentPage + 2);

                            for (let i = start; i <= end; i++) {
                                pages.push(i);
                            }
                            return pages;
                        }
                    },

                    watch: {
                        // Áõ£ËÅΩ maxPrice ÊªëÊ°øËÆäÂåñÔºåÁ¢∫‰øù minPrice ‰∏çË∂ÖÈÅé maxPrice
                        'searchForm.maxPrice'(newVal) {
                            if (this.searchForm.minPrice > newVal) {
                                this.searchForm.minPrice = 0;
                            }
                        },
                        // Áõ£ËÅΩ minPrice Ëº∏ÂÖ•ËÆäÂåñÔºåÁ¢∫‰øù‰∏çË∂ÖÈÅé maxPrice
                        'searchForm.minPrice'(newVal) {
                            if (newVal > this.searchForm.maxPrice) {
                                this.searchForm.minPrice = this.searchForm.maxPrice;
                            }
                        }
                    },

                    async mounted() {
                        await this.loadInitialData();

                        // Áõ£ËÅΩËû¢ÂπïÂ§ßÂ∞èËÆäÂåñ
                        this.handleResize = () => {
                            this.$forceUpdate(); // Âº∑Âà∂Êõ¥Êñ∞‰ª•ÈáçÊñ∞Ë®àÁÆó isMobileOrTablet()
                        };
                        window.addEventListener('resize', this.handleResize);
                    },

                    beforeUnmount() {
                        if (this.handleResize) {
                            window.removeEventListener('resize', this.handleResize);
                        }
                    },

                    methods: {
                        // ËºâÂÖ•ÂàùÂßãË≥áÊñô
                        async loadInitialData() {
                            try {
                                await Promise.all([
                                    this.loadCities(),
                                    this.loadOrganizationTypes(),
                                    this.loadFeatureServices()
                                ]);

                                // ÊÅ¢Âæ©ÊêúÂ∞ãÊ¢ù‰ª∂
                                await this.restoreSearchState();
                            } catch (error) {
                                this.errorMessage = 'ËºâÂÖ•Âü∫Êú¨Ë≥áÊñôÂ§±ÊïóÔºåË´ãÈáçÊñ∞Êï¥ÁêÜÈ†ÅÈù¢';
                            }
                        },

                        // ËºâÂÖ•ÂüéÂ∏ÇÂàóË°®
                        async loadCities() {
                            try {
                                const response = await orgApi.getCities();
                                this.cities = response.data;
                            } catch (error) {
                                this.errorMessage = error.message;
                            }
                        },

                        // ËºâÂÖ•Ê©üÊßãÈ°ûÂûã
                        async loadOrganizationTypes() {
                            try {
                                const response = await orgApi.getOrganizationTypes();
                                this.organizationTypes = response.data;
                            } catch (error) {
                                this.errorMessage = error.message;
                            }
                        },

                        // ËºâÂÖ•ÁâπËâ≤ÊúçÂãôË≥áÊñô
                        async loadFeatureServices() {
                            try {
                                const response = await orgApi.getFeatureServices();
                                response.data.forEach(service => {
                                    this.featureServicesCache.set(service.name, service.imageUrl);
                                });
                            } catch (error) {
                                // ÁâπËâ≤ÊúçÂãôËºâÂÖ•Â§±Êïó‰∏çÂΩ±Èüø‰∏ªË¶ÅÂäüËÉΩ
                            }
                        },

                        // ÂüéÂ∏ÇËÆäÊõ¥ÊôÇËºâÂÖ•ÂçÄÂüü
                        async onCityChange() {
                            this.searchForm.districtId = 0;
                            this.districts = [];

                            if (this.searchForm.cityId && this.searchForm.cityId !== 0) {
                                try {
                                    const response = await orgApi.getDistricts(this.searchForm.cityId);
                                    this.districts = response.data;
                                } catch (error) {
                                    this.errorMessage = error.message;
                                }
                            }
                        },

                        // ÂÖ®ÈÅ∏ÈÇèËºØ
                        toggleSelectAll() {
                            if (this.selectAll) {
                                this.searchForm.organizationTypeIds = this.organizationTypes.map(type => type.id);
                            } else {
                                this.searchForm.organizationTypeIds = [];
                            }
                        },

                        // Ê©üÊßãÈ°ûÂûãËÆäÊõ¥
                        onTypeChange() {
                            const allSelected = this.organizationTypes.every(type =>
                                this.searchForm.organizationTypeIds.includes(type.id)
                            );
                            this.selectAll = allSelected;
                        },

                        // Âü∑Ë°åÊñ∞ÊêúÂ∞ãÔºàÊ∏ÖÁ©∫Âø´ÂèñÔºâ
                        performNewSearch() {
                            this.allSearchResults = [];
                            this.searchOrganizations(1);
                        },

                        // ËÆäÊõ¥ÊØèÈ†ÅÈ°ØÁ§∫Á≠ÜÊï∏
                        changePageSize() {
                            // Ë®àÁÆóÁï∂ÂâçË≥áÊñôÂú®Êñ∞ÂàÜÈ†Å‰∏≠ÁöÑ‰ΩçÁΩÆ
                            const currentFirstItem = (this.currentPage - 1) * this.pageSize + 1;
                            const newPage = Math.ceil(currentFirstItem / this.pageSize);

                            if (this.allSearchResults.length > 0) {
                                // Â¶ÇÊûúÊúâÊêúÂ∞ãÁµêÊûúÔºåÈáçÊñ∞ÂàÜÈ†Å
                                this.applySortingAndPagination(newPage);
                            } else {
                                // Â¶ÇÊûúÊ≤íÊúâÊêúÂ∞ãÁµêÊûúÔºåÈáçÊñ∞ÊêúÂ∞ã
                                this.searchOrganizations(1);
                            }
                        },

                        // ÊêúÂ∞ãÊ©üÊßã
                        async searchOrganizations(page = 1) {
                            this.loading = true;
                            this.errorMessage = '';
                            this.currentPage = page;

                            try {
                                // Â¶ÇÊûúÊòØÊñ∞ÊêúÂ∞ãÊàñÊéíÂ∫èËÆäÊõ¥ÔºåÈúÄË¶ÅÈáçÊñ∞Áç≤ÂèñÂÖ®ÈÉ®Ë≥áÊñô
                                if (page === 1 || !this.allSearchResults.length) {
                                    const requestData = {
                                        keyword: this.searchForm.keyword || '',
                                        cityId: (this.searchForm.cityId && this.searchForm.cityId != 0 && this.searchForm.cityId != '0') ? parseInt(this.searchForm.cityId) : null,
                                        districtId: (this.searchForm.districtId && this.searchForm.districtId != 0 && this.searchForm.districtId != '0') ? parseInt(this.searchForm.districtId) : null,
                                        minPrice: this.searchForm.minPrice && this.searchForm.minPrice > 0 ? parseInt(this.searchForm.minPrice) : null,
                                        maxPrice: this.searchForm.maxPrice && this.searchForm.maxPrice < 500000 ? parseInt(this.searchForm.maxPrice) : null,
                                        organizationTypeIds: this.searchForm.organizationTypeIds || [],
                                        featureServiceIds: this.searchForm.featureServiceIds || [],
                                        page: 1,
                                        pageSize: 1000 // ÂèñÂæóÊâÄÊúâÁµêÊûú
                                    };

                                    const response = await orgApi.searchOrganizations(requestData);
                                    this.allSearchResults = response.data.items || [];
                                    this.totalResults = response.data.totalCount || 0;
                                }

                                // ÊáâÁî®ÊéíÂ∫è
                                this.applySortingAndPagination(page);
                                this.hasSearched = true;
                                this.errorMessage = '';

                            } catch (error) {
                                if (error.response?.status === 400) {
                                    const errorData = error.response.data;
                                    if (errorData && errorData.errors) {
                                        const errorMessages = [];
                                        for (const [field, messages] of Object.entries(errorData.errors)) {
                                            errorMessages.push(...messages);
                                        }
                                        this.errorMessage = `Ë´ãÊ±ÇÂèÉÊï∏ÈåØË™§Ôºö${errorMessages.join('; ')}`;
                                    } else {
                                        this.errorMessage = 'ÊêúÂ∞ãÂèÉÊï∏ÊúâË™§ÔºåË´ãÊ™¢Êü•Ëº∏ÂÖ•Ê¢ù‰ª∂';
                                    }
                                } else if (error.response?.status === 500) {
                                    this.errorMessage = '‰º∫ÊúçÂô®ÂÖßÈÉ®ÈåØË™§ÔºåË´ãÁ®çÂæåÂÜçË©¶';
                                } else if (error.code === 'NETWORK_ERROR' || error.message.includes('Network Error')) {
                                    this.errorMessage = 'Á∂≤Ë∑ØÈÄ£Á∑öÈåØË™§ÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÁãÄÊÖã';
                                } else {
                                    this.errorMessage = `ÊêúÂ∞ãÂ§±ÊïóÔºö${error.message || 'Êú™Áü•ÈåØË™§'}`;
                                }

                                this.searchResults = [];
                                this.totalResults = 0;
                            } finally {
                                this.loading = false;
                            }
                        },

                        // ÂàÜÈ†ÅÂ∞éËà™
                        goToPage(page) {
                            if (page >= 1 && page <= this.totalPages && page !== this.currentPage) {
                                // Â¶ÇÊûúÂ∑≤Á∂ìÊúâÂÖ®ÈÉ®Ë≥áÊñôÔºåÁõ¥Êé•‰ΩøÁî®ÂâçÁ´ØÂàÜÈ†Å
                                if (this.allSearchResults.length > 0) {
                                    this.applySortingAndPagination(page);
                                } else {
                                    // Âê¶ÂâáÈáçÊñ∞ÊêúÂ∞ã
                                    this.searchOrganizations(page);
                                }
                                // ÊªæÂãïÂà∞È†ÇÈÉ®
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                            }
                        },

                        // ÊáâÁî®ÊéíÂ∫èÂíåÂàÜÈ†Å
                        applySortingAndPagination(page) {
                            let sortedResults = [...this.allSearchResults];

                            // ÊáâÁî®Â§öÈáçÊéíÂ∫èÔºàÂÉπÊ†ºÂÑ™ÂÖàÔºåÂ∫ä‰ΩçÂÖ∂Ê¨°Ôºâ
                            if (this.priceSortBy || this.bedSortBy) {
                                sortedResults.sort((a, b) => {
                                    // Á¨¨‰∏ÄÂ±§ÊéíÂ∫èÔºöÂÉπÊ†º
                                    if (this.priceSortBy) {
                                        const priceA = a.minMonthlyPrice || 0;
                                        const priceB = b.minMonthlyPrice || 0;

                                        if (priceA !== priceB) {
                                            return this.priceSortBy === 'asc' ? priceA - priceB : priceB - priceA;
                                        }
                                    }

                                    // Á¨¨‰∫åÂ±§ÊéíÂ∫èÔºöÂ∫ä‰ΩçÔºàÂÉπÊ†ºÁõ∏ÂêåÊôÇÊâçÊØîËºÉÂ∫ä‰ΩçÔºâ
                                    if (this.bedSortBy) {
                                        const bedA = a.bedCount || 0;
                                        const bedB = b.bedCount || 0;
                                        return this.bedSortBy === 'asc' ? bedA - bedB : bedB - bedA;
                                    }

                                    return 0; // ‰øùÊåÅÂéüÂßãÈ†ÜÂ∫è
                                });
                            }

                            // Ë®àÁÆóÂàÜÈ†Å
                            this.totalPages = Math.ceil(this.totalResults / this.pageSize);
                            this.currentPage = page;

                            // Áç≤ÂèñÁï∂ÂâçÈ†ÅÁöÑË≥áÊñô
                            const startIndex = (page - 1) * this.pageSize;
                            const endIndex = startIndex + this.pageSize;
                            this.searchResults = sortedResults.slice(startIndex, endIndex);
                        },

                        // ËôïÁêÜÂç°ÁâáÈªûÊìä‰∫ã‰ª∂
                        handleCardClick(organizationId, event) {
                            // Âè™Âú®ÊâãÊ©ü/Âπ≥ÊùøÊ®°Âºè‰∏ãËôïÁêÜÊï¥ÂºµÂç°ÁâáÁöÑÈªûÊìä
                            if (this.isMobileOrTablet()) {
                                this.viewDetail(organizationId);
                            }
                        },

                        // Ê™¢Ê∏¨ÊòØÂê¶ÁÇ∫ÊâãÊ©üÊàñÂπ≥ÊùøÊ®°Âºè
                        isMobileOrTablet() {
                            return window.innerWidth < 992; // Bootstrap lg breakpoint
                        },

                        // Êü•ÁúãË©≥Á¥∞Ë≥áÊñô
                        viewDetail(organizationId) {
                            // ‰øùÂ≠òÁï∂ÂâçÊêúÂ∞ãÊ¢ù‰ª∂Âà∞ localStorage
                            const searchState = {
                                searchForm: { ...this.searchForm },
                                currentPage: this.currentPage,
                                priceSortBy: this.priceSortBy,
                                bedSortBy: this.bedSortBy,
                                pageSize: this.pageSize,
                                timestamp: Date.now()
                            };
                            localStorage.setItem('orgSearchState', JSON.stringify(searchState));

                            window.location.href = `/orgs/orgDetail.html?id=${organizationId}`;
                        },

                        // Ê†ºÂºèÂåñÂÉπÊ†º
                        formatPrice(price) {
                            return new Intl.NumberFormat('zh-TW').format(price);
                        },

                        // ÂèñÂæóÁâπËâ≤ÊúçÂãôÂúñÁâá
                        getFeatureServiceImage(serviceName) {
                            const imageUrl = this.featureServicesCache.get(serviceName);

                            if (imageUrl) {
                                return this.getImageUrl(imageUrl);
                            }

                            return null;
                        },

                        // ÂèñÂæóÂúñÁâá URL - ‰ΩøÁî®ÂæåÂè∞ APIÔºàËàá LoadPlate.js Áõ∏ÂêåÊñπÂºèÔºâ
                        getImageUrl(fileName) {
                            if (!fileName) {
                                return null;
                            }

                            // ‰ΩøÁî®ÂæåÂè∞ API Áõ¥Êé•ÂèñÂæóÂúñÁâáÔºåËàá LoadPlate.js ‰øùÊåÅ‰∏ÄËá¥
                            const imageUrl = `${BACKEND_BASE_URL}/api/UploadFile/GetFile?fileName=${encodeURIComponent(fileName)}`;
                            return imageUrl;
                        },

                        // ÂúñÁâáËºâÂÖ•ÈåØË™§ËôïÁêÜ
                        handleImageError(event) {
                            const img = event.target;
                            img.onerror = null;
                            this.showDefaultImage(img);
                        },

                        // È°ØÁ§∫È†êË®≠ÂúñÁâáÊ®£Âºè
                        showDefaultImage(img) {
                            img.style.display = 'none';
                            const parent = img.closest('.card-img-container');
                            if (parent) {
                                parent.classList.add('no-image');
                            }
                            img.onerror = null;
                        },

                        // ÁâπËâ≤ÊúçÂãôÂúñÁâáËºâÂÖ•ÈåØË™§ËôïÁêÜ
                        handleFeatureServiceImageError(event) {
                            const img = event.target;
                            img.onerror = null;
                            img.style.display = 'none';
                            const parent = img.closest('.feature-service-item');
                            if (parent && !parent.querySelector('.feature-service-placeholder')) {
                                const placeholder = document.createElement('div');
                                placeholder.className = 'feature-service-placeholder';
                                placeholder.innerHTML = '<i class="bi bi-star"></i>';
                                parent.appendChild(placeholder);
                            }
                        },

                        // ÊÅ¢Âæ©ÊêúÂ∞ãÊ¢ù‰ª∂
                        async restoreSearchState() {
                            try {
                                const savedState = localStorage.getItem('orgSearchState');
                                if (!savedState) return;

                                const searchState = JSON.parse(savedState);
                                const now = Date.now();
                                const oneHour = 60 * 60 * 1000;

                                if (now - searchState.timestamp > oneHour) {
                                    localStorage.removeItem('orgSearchState');
                                    return;
                                }

                                this.searchForm = { ...searchState.searchForm };

                                // ÊÅ¢Âæ©ÊéíÂ∫èÁãÄÊÖã
                                if (searchState.priceSortBy !== undefined) {
                                    this.priceSortBy = searchState.priceSortBy;
                                }
                                if (searchState.bedSortBy !== undefined) {
                                    this.bedSortBy = searchState.bedSortBy;
                                }
                                // ÊÅ¢Âæ©ÊØèÈ†ÅÈ°ØÁ§∫Á≠ÜÊï∏
                                if (searchState.pageSize !== undefined) {
                                    this.pageSize = searchState.pageSize;
                                }
                                // ÂÖºÂÆπËàäÁâàÊú¨ÁöÑ sortBy
                                if (searchState.sortBy && !searchState.priceSortBy && !searchState.bedSortBy) {
                                    if (searchState.sortBy.includes('price')) {
                                        this.priceSortBy = searchState.sortBy.includes('asc') ? 'asc' : 'desc';
                                    } else if (searchState.sortBy.includes('bed')) {
                                        this.bedSortBy = searchState.sortBy.includes('asc') ? 'asc' : 'desc';
                                    }
                                }

                                if (this.searchForm.cityId > 0) {
                                    await this.onCityChange();
                                }

                                await this.searchOrganizations(searchState.currentPage || 1);
                                localStorage.removeItem('orgSearchState');

                            } catch (error) {
                                localStorage.removeItem('orgSearchState');
                            }
                        }
                    }
                }).mount('#searchApp');
            }

            // Á´ãÂç≥Âü∑Ë°åÔºàÂ§ñÂ±§ post-load Â∑≤Á¢∫‰øùÊôÇÊ©üÊ≠£Á¢∫Ôºâ
            initPageVue();
        })();

        // ===== Âú®‰∏äÈù¢ÊîæÈ†ÅÈù¢Â∞àÂ±¨ÁöÑ JSÔºàÂè™ÊúÉÂú®ÊâÄÊúâÁâáÊÆµËàáË≥áÊ∫êËºâÂÖ•ÂÆåÊàêÂæåÂü∑Ë°åÔºâ =====
    });
</script>

</html>